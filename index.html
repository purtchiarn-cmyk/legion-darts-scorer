<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Legion Darts Scorer v2.1</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f0f8ff;
        color: #333;
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 0;
        padding: 10px;
    }
    h1 { text-align: center; color: #004080; }
    #scoreboard {
        display: flex;
        justify-content: space-around;
        width: 100%;
        max-width: 500px;
        margin-bottom: 10px;
    }
    .player {
        text-align: center;
        width: 45%;
    }
    .player h2 { margin: 5px 0; }
    .score { font-size: 2em; margin: 5px 0; }
    .dart-chips { display: flex; justify-content: center; margin: 5px 0; }
    .chip {
        width: 30px;
        height: 30px;
        margin: 0 5px;
        border-radius: 50%;
        background: #e0e0e0;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    .active { border: 2px solid #004080; }
    .double { background: #add8e6; }
    .treble { background: #ff9999; }
    .bull { background: #ffd700; }
    #buttons { display: flex; flex-direction: row; margin-bottom: 10px; }
    #left-col { display: flex; flex-direction: column; margin-right: 5px; }
    .left-btn {
        width: 60px; height: 50px; margin: 2px;
        font-size: 1.2em; cursor: pointer;
    }
    #numbers { display: grid; grid-template-columns: repeat(5, 60px); grid-gap: 2px; }
    .num-btn {
        width: 60px; height: 50px;
        font-size: 1.2em;
        cursor: pointer;
    }
    #controls { margin-top: 10px; display: flex; justify-content: center; }
    #controls button {
        padding: 10px 20px;
        margin: 0 5px;
        font-size: 1em;
        cursor: pointer;
    }
    #stats { margin-top: 5px; font-size: 0.9em; color: red; text-align: center; }
</style>
</head>
<body>

<h1>Legion Darts Scorer</h1>

<div id="scoreboard">
    <div class="player" id="home">
        <h2>Home (P1)</h2>
        <div class="score" id="homeScore">501</div>
        <div class="dart-chips">
            <div class="chip" id="homeD1">1</div>
            <div class="chip" id="homeD2">2</div>
            <div class="chip" id="homeD3">3</div>
        </div>
    </div>
    <div class="player" id="away">
        <h2>Away (P2)</h2>
        <div class="score" id="awayScore">501</div>
        <div class="dart-chips">
            <div class="chip" id="awayD1">1</div>
            <div class="chip" id="awayD2">2</div>
            <div class="chip" id="awayD3">3</div>
        </div>
    </div>
</div>

<div id="stats">
    <div id="home3DA">3DA: 0.0</div>
    <div id="away3DA">3DA: 0.0</div>
</div>

<div id="buttons">
    <div id="left-col">
        <button class="left-btn" data-type="D">D</button>
        <button class="left-btn" data-type="T">T</button>
        <button class="left-btn" data-type="25">25</button>
        <button class="left-btn" data-type="BULL">Bull</button>
        <button class="left-btn" data-type="COIN">ðŸ’°</button>
    </div>
    <div id="numbers">
        <!-- Numbers 1-20 -->
        <script>
            for(let i=1;i<=20;i++){
                document.write('<button class="num-btn" data-num="'+i+'">'+i+'</button>');
            }
        </script>
    </div>
</div>

<div id="controls">
    <button id="undoBtn">Undo Last Dart</button>
    <button id="submitBtn">Submit Turn</button>
</div>

<script>
let homeScore = 501, awayScore = 501;
let currentPlayer = 'home';
let currentDart = 0;
let darts = [0,0,0];
let multiplier = 1;

// Update dart chip highlight
function updateDartChips() {
    ['home','away'].forEach(p=>{
        for(let i=1;i<=3;i++){
            let chip=document.getElementById(p+'D'+i);
            chip.className='chip'+(currentPlayer===p && currentDart===i-1?' active':'');
        }
    });
}

// Update score displays
function updateScoreboard() {
    document.getElementById('homeScore').textContent = homeScore;
    document.getElementById('awayScore').textContent = awayScore;
    let home3DA = dartsSum('home');
    let away3DA = dartsSum('away');
    document.getElementById('home3DA').textContent='3DA: '+home3DA.toFixed(1);
    document.getElementById('away3DA').textContent='3DA: '+away3DA.toFixed(1);
}

function dartsSum(player){
    let total=0;
    let d=darts[player==='home'?0:3];
    for(let i=0;i<3;i++) total += darts[i];
    return 501-total; // Simplified for placeholder
}

// Left column buttons
document.querySelectorAll('.left-btn').forEach(b=>{
    b.addEventListener('click',()=> {
        let type=b.dataset.type;
        if(type==='D') multiplier=2;
        else if(type==='T') multiplier=3;
        else if(type==='25'){ darts[currentDart]=25*1; nextDart(); return; }
        else if(type==='BULL'){ darts[currentDart]=50; nextDart(); return; }
        else multiplier=1;
    });
});

// Number buttons
document.querySelectorAll('.num-btn').forEach(b=>{
    b.addEventListener('click',()=> {
        darts[currentDart]=parseInt(b.dataset.num)*multiplier;
        nextDart();
    });
});

function nextDart(){
    currentDart++;
    if(currentDart>2){
        // Auto wait for submit
        currentDart=2;
    }
    updateDartChips();
    updateScoreboard();
}

// Undo last dart
document.getElementById('undoBtn').addEventListener('click',()=>{
    if(currentDart>0){
        currentDart--;
        darts[currentDart]=0;
        updateDartChips();
        updateScoreboard();
    }
});

// Submit turn
document.getElementById('submitBtn').addEventListener('click',()=>{
    let turnScore = darts.reduce((a,b)=>a+b,0);
    if(currentPlayer==='home'){
        homeScore -= turnScore;
        currentPlayer='away';
    } else {
        awayScore -= turnScore;
        currentPlayer='home';
    }
    darts=[0,0,0]; currentDart=0; multiplier=1;
    updateDartChips();
    updateScoreboard();
});

// Initialize
updateDartChips();
updateScoreboard();
</script>

</body>
</html>